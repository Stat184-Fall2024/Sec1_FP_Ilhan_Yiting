geom_text(aes(label = goalsConceded), vjust = -0.5, size = 3.5) + # Add text labels on top of the bars
scale_fill_gradient(low = "blue", high = "red") + # Color gradient based on goals conceded
labs(
title = "Total Goals Conceded by Each Club (High to Low)",
x = "Club",
y = "Goals Conceded",
fill = "Goals Conceded"
) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
# Display the bar plot
print(goals_conceded_plot)
View(Laliga_table_xg_2023_24)
# Load necessary libraries
library(ggplot2)
library(dplyr)
library(tidyr)
# Load the data
laliga_xg <- read.csv("archive/Laliga_table_xg_2023_24.csv")
laliga_table <- read.csv("archive/Laliga_table_2023_24.csv")
# Prepare the data
laliga_table <- laliga_table %>%
separate(scoresStr, into = c("goalsScored", "goalsConceded"), sep = "-", convert = TRUE) # Extract actual goals conceded
merged_data <- laliga_xg %>%
inner_join(laliga_table, by = c("name", "played")) %>%
filter(idx.x <= 6) %>% # Filter top 6 teams (if needed)
mutate(conceded_diff = xgConceded - as.numeric(goalsConceded)) # Calculate the difference
# Divergence plot for xGConceded vs. Goals Conceded
divergence_plot <- ggplot(merged_data, aes(x = reorder(name, conceded_diff), y = conceded_diff, fill = conceded_diff > 0)) +
geom_bar(stat = "identity", width = 0.6) +
geom_text(aes(label = round(conceded_diff, 2)), vjust = ifelse(merged_data$conceded_diff > 0, -0.5, 1.5), size = 3) +
scale_fill_manual(
values = c(`TRUE` = "blue", `FALSE` = "red"),  # Correctly formatted logical values
labels = c("Underperformance", "Overperformance")
) +
labs(
title = "Divergence Plot: xGConceded vs. Actual Goals Conceded",
subtitle = "Difference between Expected Goals Conceded (xGConceded) and Actual Goals Conceded",
x = "Team",
y = "Difference (xGConceded - Goals Conceded)",
fill = "Performance"
) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
# Display the divergence plot
print(divergence_plot)
# Load necessary libraries
library(ggplot2)
library(dplyr)
library(tidyr)
# Load the data
laliga_xg <- read_csv("archive/Laliga_table_xg_2023_24.csv")
laliga_table <- read_csv("archive/Laliga_table_2023_24.csv")
# Calculate xGA and prepare the data
laliga_xg <- laliga_xg %>%
mutate(xGA = xg - xgConceded) %>%
select(name, xGA)
# Merge with goalConDiff from Laliga_table_2023_24.csv
comparison_data <- laliga_table %>%
select(name, goalConDiff) %>%
inner_join(laliga_xg, by = "name")
# Reshape the data for the paired bar chart
paired_data <- comparison_data %>%
pivot_longer(cols = c("xGA", "goalConDiff"), names_to = "Metric", values_to = "Value")
# Create the paired bar chart
paired_bar_plot <- ggplot(paired_data, aes(x = reorder(name, -Value), y = Value, fill = Metric)) +
geom_bar(stat = "identity", position = "dodge", width = 0.7) +
labs(
title = "Paired Bar Chart: xGA vs. GoalConDiff",
subtitle = "Comparing Expected Goal Contribution and Goal Differential for Each Team",
x = "Team",
y = "Value",
fill = "Metric"
) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
# Display the plot
print(paired_bar_plot)
# Load necessary libraries
library(ggplot2)
library(dplyr)
library(tidyr)
# Load the data
laliga_xg <- read_csv("archive/Laliga_table_xg_2023_24.csv")
laliga_table <- read_csv("archive/Laliga_table_2023_24.csv")
# Calculate xGA and prepare the data
laliga_xg <- laliga_xg %>%
mutate(xGA = xg - xgConceded) %>%
select(name, xGA)
# Merge with goalConDiff from Laliga_table_2023_24.csv
comparison_data <- laliga_table %>%
select(name, goalConDiff) %>%
inner_join(laliga_xg, by = "name")
# Reshape the data for the paired bar chart
paired_data <- comparison_data %>%
pivot_longer(cols = c("xGA", "GA"), names_to = "Metric", values_to = "Value")
# Load necessary libraries
library(ggplot2)
library(dplyr)
library(tidyr)
# Load the data
laliga_xg <- read_csv("archive/Laliga_table_xg_2023_24.csv")
laliga_table <- read_csv("archive/Laliga_table_2023_24.csv")
# Calculate xGA and prepare the data
laliga_xg <- laliga_xg %>%
mutate(xGA = xg - xgConceded) %>%
select(name, xGA)
# Merge with goalConDiff from Laliga_table_2023_24.csv
comparison_data <- laliga_table %>%
select(name, goalConDiff) %>%
inner_join(laliga_xg, by = "name")
# Reshape the data for the paired bar chart
paired_data <- comparison_data %>%
pivot_longer(cols = c("xGA", "goalConDiff"), names_to = "Metric", values_to = "Value")
# Create the paired bar chart
paired_bar_plot <- ggplot(paired_data, aes(x = reorder(name, -Value), y = Value, fill = Metric)) +
geom_bar(stat = "identity", position = "dodge", width = 0.7) +
labs(
title = "Paired Bar Chart: xGA vs. GoalConDiff",
subtitle = "Comparing Expected Goal Contribution and Goal Differential for Each Team",
x = "Team",
y = "Value",
fill = "Metric"
) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
# Display the plot
print(paired_bar_plot)
# Load necessary libraries
library(ggplot2)
library(dplyr)
library(tidyr)
# Load the data
laliga_xg <- read_csv("archive/Laliga_table_xg_2023_24.csv")
laliga_table <- read_csv("archive/Laliga_table_2023_24.csv")
# Calculate xGA and prepare the data
laliga_xg <- laliga_xg %>%
mutate(xGA = xg - xgConceded) %>%
select(name, xGA)
# Merge with goalConDiff from Laliga_table_2023_24.csv
comparison_data <- laliga_table %>%
select(name, goalConDiff) %>%
inner_join(laliga_xg, by = "name")
# Reshape the data for the paired bar chart
paired_data <- comparison_data %>%
pivot_longer(cols = c("xGA", "goalConDiff"), names_to = "Metric", values_to = "Value")
# Create the paired bar chart
paired_bar_plot <- ggplot(paired_data, aes(x = reorder(name, -Value), y = Value, fill = Metric)) +
geom_bar(stat = "identity", position = "dodge", width = 0.7) +
labs(
title = "Paired Bar Chart: xGA vs. GoalConDiff",
subtitle = "Comparing Expected Goal Contribution and Goal Differential for Each Team",
x = "Team",
y = "Value",
fill = "Metric"
) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
# Display the plot
print(paired_bar_plot)
# Calculate xGA and prepare the data
laliga_xg <- laliga_xg %>%
mutate(xGA = xg - xgConceded) %>%
select(name, xGA)
# Load necessary libraries
library(ggplot2)
library(dplyr)
library(tidyr)
# Load the data
laliga_xg <- read_csv("archive/Laliga_table_xg_2023_24.csv")
laliga_table <- read_csv("archive/Laliga_table_2023_24.csv")
# Calculate xGA and prepare the data
laliga_xg <- laliga_xg %>%
mutate(xGA = xg - xgConceded) %>%
select(name, xGA)
# Merge with goalConDiff from Laliga_table_2023_24.csv
comparison_data <- laliga_table %>%
select(name, goalConDiff) %>%
inner_join(laliga_xg, by = "name")
# Reshape the data for the paired bar chart
paired_data <- comparison_data %>%
pivot_longer(cols = c("xGA", "goalConDiff"), names_to = "Metric", values_to = "Value")
# Create the paired bar chart
paired_bar_plot <- ggplot(paired_data, aes(x = reorder(name, -Value), y = Value, fill = Metric)) +
geom_bar(stat = "identity", position = "dodge", width = 0.7) +
labs(
title = "Paired Bar Chart: xGA vs. GoalConDiff",
subtitle = "Comparing Expected Goal Contribution and Goal Differential for Each Team",
x = "Team",
y = "Value",
fill = "Metric"
) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
# Display the plot
print(paired_bar_plot)
# Load necessary libraries
library(ggplot2)
library(dplyr)
library(tidyr)
# Load the data
laliga_xg <- read.csv("archive/Laliga_table_xg_2023_24.csv")
laliga_table <- read.csv("archive/Laliga_table_2023_24.csv")
# Calculate xGA and prepare the data
laliga_xg <- laliga_xg %>%
mutate(xGA = xg - xgConceded) %>%
select(name, xGA)
# Merge with goalConDiff from Laliga_table_2023_24.csv
comparison_data <- laliga_table %>%
select(name, goalConDiff) %>%
inner_join(laliga_xg, by = "name")
# Reshape the data for the paired bar chart
paired_data <- comparison_data %>%
pivot_longer(cols = c("xGA", "goalConDiff"), names_to = "Metric", values_to = "Value")
# Create the paired bar chart
paired_bar_plot <- ggplot(paired_data, aes(x = reorder(name, -Value), y = Value, fill = Metric)) +
geom_bar(stat = "identity", position = "dodge", width = 0.7) +
labs(
title = "Paired Bar Chart: xGA vs. GoalConDiff",
subtitle = "Comparing Expected Goal Contribution and Goal Differential for Each Team",
x = "Team",
y = "Value",
fill = "Metric"
) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
# Display the plot
print(paired_bar_plot)
# Load necessary libraries
library(ggplot2)
library(dplyr)
library(tidyr)
# Load the data
laliga_xg <- read.csv("archive/Laliga_table_xg_2023_24.csv")
laliga_table <- read.csv("archive/Laliga_table_2023_24.csv")
# Calculate xGA and prepare the data
laliga_xg <- laliga_xg %>%
mutate(xGA = xg - xgConceded) %>%
select(name, xGA)
# Merge with goalConDiff from Laliga_table_2023_24.csv
comparison_data <- laliga_table %>%
select(name, goalConDiff) %>%
inner_join(laliga_xg, by = "name")
# Reshape the data for the paired bar chart
paired_data <- comparison_data %>%
pivot_longer(cols = c("xGA", "goalConDiff"), names_to = "Metric", values_to = "Value")
# Create the paired bar chart
paired_bar_plot <- ggplot(paired_data, aes(x = reorder(name, -Value), y = Value, fill = Metric)) +
geom_bar(stat = "identity", position = "dodge", width = 0.7) +
labs(
title = "Paired Bar Chart: xGA vs. GoalConDiff",
subtitle = "Comparing Expected Goal Contribution and Goal Differential for Each Team",
x = "Team",
y = "Value",
fill = "Metric"
) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
# Display the plot
print(paired_bar_plot)
# Load necessary libraries
library(dplyr)
# Prepare the data
laliga_table <- laliga_table %>%
mutate(goalsConceded = as.numeric(goalsConceded)) # Ensure 'goalsConceded' is numeric
# Load necessary libraries
library(dplyr)
laliga_table <- read.csv("archive/Laliga_table_2023_24.csv")
# Prepare the data
laliga_table <- laliga_table %>%
mutate(goalsConceded = as.numeric(goalsConceded)) # Ensure 'goalsConceded' is numeric
# Load necessary libraries
library(dplyr)
laliga_table <- read.csv("archive/Laliga_table_2023_24.csv")
laliga_table <- laliga_table %>%
separate(scoresStr, into = c("goalsScored", "goalsConceded"), sep = "-", convert = TRUE) # Extract actual goals conceded
# Prepare the data
laliga_table <- laliga_table %>%
mutate(goalsConceded = as.numeric(goalsConceded)) # Ensure 'goalsConceded' is numeric
# Calculate summary statistics
summary_stats <- laliga_table %>%
summarize(
num_teams = n(),
min_goals = min(goalsConceded, na.rm = TRUE),
Q1 = quantile(goalsConceded, 0.25, na.rm = TRUE),
median = median(goalsConceded, na.rm = TRUE),
Q3 = quantile(goalsConceded, 0.75, na.rm = TRUE),
max_goals = max(goalsConceded, na.rm = TRUE),
MAD = mean(abs(goalsConceded - mean(goalsConceded, na.rm = TRUE)), na.rm = TRUE), # Mean Absolute Deviation
SAM = sum(abs(goalsConceded - mean(goalsConceded, na.rm = TRUE)), na.rm = TRUE), # Sum of Absolute Deviations
SASD = sum((goalsConceded - mean(goalsConceded, na.rm = TRUE))^2, na.rm = TRUE)  # Sum of Squared Deviations
)
# Find Atlético Madrid's stats
atletico_stats <- laliga_table %>%
filter(name == "Atlético Madrid") %>%
select(name, goalsConceded)
# Compare Atlético Madrid's goalsConceded against summary statistics
comparison <- summary_stats %>%
mutate(
Atletico_GoalsConceded = atletico_stats$goalsConceded,
is_above_median = atletico_stats$goalsConceded > median,
is_above_Q3 = atletico_stats$goalsConceded > Q3,
is_below_Q1 = atletico_stats$goalsConceded < Q1
)
# Load necessary libraries
library(dplyr)
# Load the La Liga data
laliga_table <- read.csv("path/to/Laliga_table_2023_24.csv")
# Load necessary libraries
library(dplyr)
# Load the La Liga data
laliga_table <- read.csv("archive/Laliga_table_2023_24.csv")
# Extract goalsConceded from scoresStr
laliga_table <- laliga_table %>%
separate(scoresStr, into = c("goalsScored", "goalsConceded"), sep = "-", convert = TRUE)
# Ensure 'goalsConceded' is numeric
laliga_table <- laliga_table %>%
mutate(goalsConceded = as.numeric(goalsConceded))
# Calculate summary statistics
summary_stats <- laliga_table %>%
summarize(
num_teams = n(),
min_goals = min(goalsConceded, na.rm = TRUE),
Q1 = quantile(goalsConceded, 0.25, na.rm = TRUE),
median = median(goalsConceded, na.rm = TRUE),
Q3 = quantile(goalsConceded, 0.75, na.rm = TRUE),
max_goals = max(goalsConceded, na.rm = TRUE),
MAD = mean(abs(goalsConceded - mean(goalsConceded, na.rm = TRUE)), na.rm = TRUE), # Mean Absolute Deviation
SAM = sum(abs(goalsConceded - mean(goalsConceded, na.rm = TRUE)), na.rm = TRUE), # Sum of Absolute Deviations
SASD = sum((goalsConceded - mean(goalsConceded, na.rm = TRUE))^2, na.rm = TRUE)  # Sum of Squared Deviations
)
# Find Atlético Madrid's stats
atletico_stats <- laliga_table %>%
filter(name == "Atletico Madrid") %>%
select(name, goalsConceded)
# Compare Atlético Madrid's goalsConceded against summary statistics
comparison <- summary_stats %>%
mutate(
Atletico_GoalsConceded = atletico_stats$goalsConceded,
is_above_median = atletico_stats$goalsConceded > median,
is_above_Q3 = atletico_stats$goalsConceded > Q3,
is_below_Q1 = atletico_stats$goalsConceded < Q1
)
# Print the comparison
print(comparison)
# Load necessary libraries
library(dplyr)
# Load the La Liga data
laliga_table <- read.csv("archive/Laliga_table_2023_24.csv")
# Extract goalsConceded from scoresStr
laliga_table <- laliga_table %>%
separate(scoresStr, into = c("goalsScored", "goalsConceded"), sep = "-", convert = TRUE)
# Ensure 'goalsConceded' is numeric
laliga_table <- laliga_table %>%
mutate(goalsConceded = as.numeric(goalsConceded))
# Calculate summary statistics
summary_stats <- laliga_table %>%
summarize(
num_teams = n(),
min_goals = min(goalsConceded, na.rm = TRUE),
Q1 = quantile(goalsConceded, 0.25, na.rm = TRUE),
median = median(goalsConceded, na.rm = TRUE),
Q3 = quantile(goalsConceded, 0.75, na.rm = TRUE),
max_goals = max(goalsConceded, na.rm = TRUE),
MAD = mean(abs(goalsConceded - mean(goalsConceded, na.rm = TRUE)), na.rm = TRUE), # Mean Absolute Deviation
SAM = sum(abs(goalsConceded - mean(goalsConceded, na.rm = TRUE)), na.rm = TRUE), # Sum of Absolute Deviations
SASD = sum((goalsConceded - mean(goalsConceded, na.rm = TRUE))^2, na.rm = TRUE)  # Sum of Squared Deviations
)
# Find Atlético Madrid's stats
atletico_stats <- laliga_table %>%
filter(name == "Atletico Madrid") %>%
select(name, goalsConceded)
# Compare Atlético Madrid's goalsConceded against summary statistics
comparison <- summary_stats %>%
mutate(
Atletico_GoalsConceded = atletico_stats$goalsConceded,
)
# Print the comparison
print(comparison)
library(dplyr)
library(tidyr)
library(knitr)
# Load the La Liga data
laliga_table <- read.csv("archive/Laliga_table_2023_24.csv")
# Extract goalsConceded from scoresStr
laliga_table <- laliga_table %>%
separate(scoresStr, into = c("goalsScored", "goalsConceded"), sep = "-", convert = TRUE)
# Ensure 'goalsConceded' is numeric
laliga_table <- laliga_table %>%
mutate(goalsConceded = as.numeric(goalsConceded))
# Calculate summary statistics
summary_stats <- laliga_table %>%
summarize(
num_teams = n(),
min_goals = min(goalsConceded, na.rm = TRUE),
Q1 = quantile(goalsConceded, 0.25, na.rm = TRUE),
median = median(goalsConceded, na.rm = TRUE),
Q3 = quantile(goalsConceded, 0.75, na.rm = TRUE),
max_goals = max(goalsConceded, na.rm = TRUE),
MAD = mean(abs(goalsConceded - mean(goalsConceded, na.rm = TRUE)), na.rm = TRUE), # Mean Absolute Deviation
SAM = sum(abs(goalsConceded - mean(goalsConceded, na.rm = TRUE)), na.rm = TRUE), # Sum of Absolute Deviations
SASD = sum((goalsConceded - mean(goalsConceded, na.rm = TRUE))^2, na.rm = TRUE)  # Sum of Squared Deviations
)
# Find Atlético Madrid's stats
atletico_stats <- laliga_table %>%
filter(name == "Atletico Madrid") %>%
select(name, goalsConceded)
# Compare Atlético Madrid's goalsConceded against summary statistics
comparison <- summary_stats %>%
mutate(
Atletico_GoalsConceded = atletico_stats$goalsConceded
)
# Display the comparison table
comparison %>%
t() %>% # Transpose for better readability
as.data.frame() %>%
rename(Value = V1) %>% # Rename the column for clarity
knitr::kable(
col.names = c("Metric", "Value"),
caption = "Summary Statistics and Atlético Madrid's Performance",
format = "pipe"
)
library(dplyr)
library(tidyr)
library(knitr)
# Load the La Liga data
laliga_table <- read.csv("archive/Laliga_table_2023_24.csv")
# Extract goalsConceded from scoresStr
laliga_table <- laliga_table %>%
separate(scoresStr, into = c("goalsScored", "goalsConceded"), sep = "-", convert = TRUE)
# Ensure 'goalsConceded' is numeric
laliga_table <- laliga_table %>%
mutate(goalsConceded = as.numeric(goalsConceded))
# Calculate summary statistics
summary_stats <- laliga_table %>%
summarize(
number_of_teams = n(),
min_goals_conceded = min(goalsConceded, na.rm = TRUE),
Q1 = quantile(goalsConceded, 0.25, na.rm = TRUE),
median = median(goalsConceded, na.rm = TRUE),
Q3 = quantile(goalsConceded, 0.75, na.rm = TRUE),
max_goals_conceded = max(goalsConceded, na.rm = TRUE),
MAD = mean(abs(goalsConceded - mean(goalsConceded, na.rm = TRUE)), na.rm = TRUE), # Mean Absolute Deviation
SAM = sum(abs(goalsConceded - mean(goalsConceded, na.rm = TRUE)), na.rm = TRUE), # Sum of Absolute Deviations
SASD = sum((goalsConceded - mean(goalsConceded, na.rm = TRUE))^2, na.rm = TRUE)  # Sum of Squared Deviations
)
# Find Atlético Madrid's stats
atletico_stats <- laliga_table %>%
filter(name == "Atletico Madrid") %>%
select(name, goalsConceded)
# Compare Atlético Madrid's goalsConceded against summary statistics
comparison <- summary_stats %>%
mutate(
Atletico_GoalsConceded = atletico_stats$goalsConceded
)
# Display the comparison table
comparison %>%
t() %>% # Transpose for better readability
as.data.frame() %>%
rename(Value = V1) %>% # Rename the column for clarity
knitr::kable(
col.names = c("Metric", "Value"),
caption = "Summary Statistics and Atlético Madrid's Performance",
format = "pipe"
)
library(dplyr)
library(tidyr)
library(knitr)
# Load the La Liga data
laliga_table <- read.csv("archive/Laliga_table_2023_24.csv")
# Extract goalsConceded from scoresStr
laliga_table <- laliga_table %>%
separate(scoresStr, into = c("goalsScored", "goalsConceded"), sep = "-", convert = TRUE)
# Ensure 'goalsConceded' is numeric
laliga_table <- laliga_table %>%
mutate(goalsConceded = as.numeric(goalsConceded))
# Calculate summary statistics
summary_stats <- laliga_table %>%
summarize(
number_of_teams = n(),
min_goals_conceded = min(goalsConceded, na.rm = TRUE),
Q1 = quantile(goalsConceded, 0.25, na.rm = TRUE),
median = median(goalsConceded, na.rm = TRUE),
Q3 = quantile(goalsConceded, 0.75, na.rm = TRUE),
max_goals_conceded = max(goalsConceded, na.rm = TRUE),
MAD = mean(abs(goalsConceded - mean(goalsConceded, na.rm = TRUE)), na.rm = TRUE), # Mean Absolute Deviation
SAM = sum(abs(goalsConceded - mean(goalsConceded, na.rm = TRUE)), na.rm = TRUE), # Sum of Absolute Deviations
SASD = sum((goalsConceded - mean(goalsConceded, na.rm = TRUE))^2, na.rm = TRUE)  # Sum of Squared Deviations
)
# Find Atlético Madrid's stats
atletico_stats <- laliga_table %>%
filter(name == "Atletico Madrid") %>%
select(name, goalsConceded)
# Compare Atlético Madrid's goalsConceded against summary statistics
comparison <- summary_stats %>%
mutate(
Atletico_GoalsConceded = atletico_stats$goalsConceded
)
# Display the comparison table
comparison %>%
t() %>% # Transpose for better readability
as.data.frame() %>%
rename(Value = V1) %>% # Rename the column for clarity
knitr::kable(
col.names = c("Metric", "Value"),
caption = "Summary Statistics and Atlético Madrid's Performance",
format = "pipe"
)
View(comparison)
knitr::include_graphics("ATM_formation.png")
View(files_descriptions)
load("/Users/jasonliu/Documents/GitHub/Sec1_FP_Ilhan_Yiting/FinalProject/.RData")
