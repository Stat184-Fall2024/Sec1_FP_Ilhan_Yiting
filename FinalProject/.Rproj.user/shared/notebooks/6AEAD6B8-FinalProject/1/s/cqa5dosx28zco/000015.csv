"0","# Load necessary libraries"
"0","library(ggplot2)"
"0","library(dplyr)"
"0","library(tidyr)"
"0","library(cowplot)"
"0",""
"0","# Load the data"
"0","laliga_xg <- read.csv(""archive/Laliga_table_xg_2023_24.csv"")"
"0","laliga_table <- read.csv(""archive/Laliga_table_2023_24.csv"")"
"0",""
"0","# Prepare the data"
"0","laliga_table <- laliga_table %>%"
"0","  separate(scoresStr, into = c(""goalsScored"", ""goalsConceded""), sep = ""-"", convert = TRUE)"
"0",""
"0","merged_data <- laliga_xg %>%"
"0","  inner_join(laliga_table, by = c(""name"", ""played"")) %>%"
"0","  filter(idx.x <= 6) # Filter top 5 teams"
"0",""
"0","# Scatter plot with arrows for xG vs. Goals Scored and automatic legend"
"0","scatter_plot <- ggplot(merged_data) +"
"0","  geom_point(aes(x = xg, y = goalsScored, color = ""Actual Goals Scored""), size = 4) + # Actual goals scored"
"0","  geom_point(aes(x = xg, y = xg, color = ""Expected Goals (xG)""), size = 4) + # Expected goals"
"0","  geom_segment(aes(x = xg, y = xg, xend = xg, yend = goalsScored, linetype = ""Difference""), "
"0","               arrow = arrow(length = unit(0.3, ""cm"")), size = 1.2, color = ""black"") + # Arrow for difference"
"0","  geom_text(aes(x = xg, y = goalsScored, label = name), vjust = -1, size = 3) + # Team names"
"0","  labs("
"0","    title = ""Comparison of Expected Goals (xG) and Actual Goals Scored in La Liga 2023/24"","
"0","    subtitle = ""Relationship between Expected and Actual Goals for the top 5 teams"","
"0","    x = ""Expected Goals (xG)"","
"0","    y = ""Goals Scored"","
"0","    color = NULL,      # Remove the word ""Legend"" for color"
"0","    linetype = NULL     # Remove the word ""Legend"" for line type"
"0","  ) +"
"0","  scale_color_manual(values = c(""Actual Goals Scored"" = ""red"", ""Expected Goals (xG)"" = ""blue"")) +"
"0","  scale_linetype_manual(values = c(""Difference"" = ""solid"")) +"
"0","  xlim(35, 80) + # Adjust x-axis range to provide more space"
"0","  theme_minimal()"
"0",""
"0","# Display the scatter plot with the adjusted x-axis"
"0","print(scatter_plot)"
