"0","# Load necessary libraries"
"0","library(dplyr)"
"0","library(fmsb)"
"0",""
"0","# Filter top 7 clubs (excluding Atlético Madrid)"
"0","top_7_clubs <- read.csv(""archive/Laliga_table_2023_24.csv"") %>%"
"0","  filter(idx <= 7, name != ""Atletico Madrid"") %>%"
"0","  pull(name)"
"0",""
"0","# Load data for metrics and calculate averages for top 7 clubs"
"0","pass_completion <- read.csv(""archive/laliga2023_34/accurate_pass_team.csv"") %>%"
"0","  filter(Team %in% top_7_clubs) %>%"
"0","  summarise(PassSuccess = mean(PassSuccess..., na.rm = TRUE))"
"0",""
"0","goals_per_game <- read.csv(""archive/laliga2023_34/team_goals_per_match.csv"") %>%"
"0","  filter(Team %in% top_7_clubs) %>%"
"0","  summarise(GoalsPerMatch = mean(GoalsperMatch, na.rm = TRUE))"
"0",""
"0","expected_goals <- read.csv(""archive/laliga2023_34/expected_goals_team.csv"") %>%"
"0","  filter(Team %in% top_7_clubs) %>%"
"0","  summarise(ExpectedGoalsPerMatch = mean(ExpectedGoals / 38, na.rm = TRUE))"
"0",""
"0","possession <- read.csv(""archive/laliga2023_34/possession_percentage_team.csv"") %>%"
"0","  filter(Team %in% top_7_clubs) %>%"
"0","  summarise(Possession = mean(Possession, na.rm = TRUE))"
"0",""
"0","goals_conceded <- read.csv(""archive/laliga2023_34/goals_conceded_team_match.csv"") %>%"
"0","  filter(Team %in% top_7_clubs) %>%"
"0","  summarise(GoalsConcededPerMatch = mean(GoalsConcededperMatch, na.rm = TRUE))"
"0",""
"0","expected_goals_against <- read.csv(""archive/laliga2023_34/expected_goals_conceded_team.csv"") %>%"
"0","  filter(Team %in% top_7_clubs) %>%"
"0","  summarise(ExpectedGoalsConcededPerMatch = mean(ExpectedGoalsConceded / 38, na.rm = TRUE))"
"0",""
"0","tackle_won <- read.csv(""archive/laliga2023_34/won_tackle_team.csv"") %>%"
"0","  filter(Team %in% top_7_clubs) %>%"
"0","  summarise(TackleSuccess = mean(TackleSuccess..., na.rm = TRUE))"
"0",""
"0","# Combine all averages into one dataframe for the top 7 clubs"
"0","top_7_averages <- data.frame("
"0","  PassSuccess = pass_completion$PassSuccess,"
"0","  GoalsPerMatch = goals_per_game$GoalsPerMatch,"
"0","  ExpectedGoalsPerMatch = expected_goals$ExpectedGoalsPerMatch,"
"0","  Possession = possession$Possession,"
"0","  GoalsConcededPerMatch = goals_conceded$GoalsConcededPerMatch,"
"0","  ExpectedGoalsConcededPerMatch = expected_goals_against$ExpectedGoalsConcededPerMatch,"
"0","  TackleSuccess = tackle_won$TackleSuccess"
"0",")"
"0",""
"0","# Load team performance data for Atlético Madrid"
"0","team_performance <- read.csv(""archive/laliga2023_34/accurate_pass_team.csv"") %>%"
"0","  select(Team, PassSuccess = PassSuccess...) %>%"
"0","  inner_join(read.csv(""archive/laliga2023_34/team_goals_per_match.csv"") %>%"
"0","               select(Team, GoalsPerMatch = GoalsperMatch), by = ""Team"") %>%"
"0","  inner_join(read.csv(""archive/laliga2023_34/expected_goals_team.csv"") %>%"
"0","               mutate(ExpectedGoalsPerMatch = ExpectedGoals / 38) %>%"
"0","               select(Team, ExpectedGoalsPerMatch), by = ""Team"") %>%"
"0","  inner_join(read.csv(""archive/laliga2023_34/possession_percentage_team.csv"") %>%"
"0","               select(Team, Possession = Possession), by = ""Team"") %>%"
"0","  inner_join(read.csv(""archive/laliga2023_34/goals_conceded_team_match.csv"") %>%"
"0","               select(Team, GoalsConcededPerMatch = GoalsConcededperMatch), by = ""Team"") %>%"
"0","  inner_join(read.csv(""archive/laliga2023_34/expected_goals_conceded_team.csv"") %>%"
"0","               mutate(ExpectedGoalsConcededPerMatch = ExpectedGoalsConceded / 38) %>%"
"0","               select(Team, ExpectedGoalsConcededPerMatch), by = ""Team"") %>%"
"0","  inner_join(read.csv(""archive/laliga2023_34/won_tackle_team.csv"") %>%"
"0","               select(Team, TackleSuccess = TackleSuccess...), by = ""Team"") %>%"
"0","  filter(Team == ""Atletico Madrid"") %>%"
"0","  select(-Team) %>%"
"0","  as.data.frame()"
"0","# Correct maximum and minimum values for radar chart scaling"
"0","max_values <- data.frame("
"0","  PassSuccess = 90,"
"0","  GoalsPerMatch = 3,"
"0","  ExpectedGoalsPerMatch = 3,"
"0","  Possession = 70,"
"0","  GoalsConcededPerMatch = 3,"
"0","  ExpectedGoalsConcededPerMatch = 3,"
"0","  TackleSuccess = 70"
"0",")"
"0",""
"0","min_values <- data.frame("
"0","  PassSuccess = 60,"
"0","  GoalsPerMatch = 1,"
"0","  ExpectedGoalsPerMatch = 1,"
"0","  Possession = 40,"
"0","  GoalsConcededPerMatch = 0.5,"
"0","  ExpectedGoalsConcededPerMatch = 0.5,"
"0","  TackleSuccess = 50"
"0",")"
"0",""
"0","# Prepare the data for radar chart"
"0","radar_data <- rbind("
"0","  max_values,"
"0","  min_values,"
"0","  top_7_averages,"
"0","  team_performance"
"0",")"
"0",""
"0","# Create the overlapping radar chart"
"0","radarchart(radar_data,"
"0","           axistype = 1,"
"0","           pcol = c(rgb(0.8, 0.4, 0.1, 0.9), rgb(0.1, 0.7, 0.1, 0.9)),  # Orange for top 7 avg, green for Atlético"
"0","           pfcol = c(rgb(0.8, 0.4, 0.1, 0.4), rgb(0.1, 0.7, 0.1, 0.4)),  # Semi-transparent fill"
"0","           plwd = 2,"
"0","           cglcol = ""grey"","
"0","           cglty = 1,"
"0","           axislabcol = ""grey"","
"0","           caxislabels = seq(0, max(unlist(max_values)), by = 10),"
"0","           cglwd = 0.8,"
"0","           vlcex = 0.8)"
